# 深搜

## acwing 166 数独

数独 是一种传统益智游戏，你需要把一个 9×9 的数独补充完整，使得数独中每行、每列、每个 3×3 的九宫格内数字 1∼9 均恰好出现一次。请编写一个程序填写数独。

### 思路

- 对于每行、每列、每个九宫格分别用一个 9 位二进制数代表哪些数还可以填（二进制的与运算，然后用 lowbit 取能填的数字）
- 填上（删去）某个数后就要对二进制数的某位改成零（一）

# 剪枝

## acwing 167 木棒

乔治拿来一组等长的木棒，将它们随机地砍断，使得每一节木棍的长度都不超过 50 个长度单位。然后他又想把这些木棍恢复到为裁截前的状态，但忘记了初始时有多少木棒以及木棒的初始长度。

请你设计一个程序，帮助乔治计算木棒的可能最小长度。每一节木棍的长度都用大于零的整数表示。

### 思路

[@tonngw](https://www.acwing.com/solution/content/121003/)

剪枝策略：

1. sum % length = 0
2. 木棍长度降序排序，以组合方式枚举搜索
3. 如果当前长度木棍没有搜到方案，跳过该长度
4. 如果木棒的第一根木棍就搜索失败，则一定搜不到方案。（交换可证）
5. 如果木棒的最后一根木棍搜索失败，则一定搜不到方案。（贪心可证）

```c++
// 正在拼第 stick 根木棍，该木棍当前长度 cab，从 start 开始枚举木棍序号 
bool dfs(int stick, int cab, int start) {
    if (stick > cnt) return true;  // 全拼好了
    if (cab == nowlen) return dfs(stick + 1, 0, 1);  // 拼下一根

    int fail = 0;  // 上一根失败的长度
    for (int i = start; i <= n; i++) {
        if (!vis[i] && fail != sticks[i] && cab + sticks[i] <= nowlen) {
            vis[i] = true;
            if(dfs(stick, cab + sticks[i], i + 1)) return true;
            vis[i] = false; fail = sticks[i];
            if (cab == 0 || cab + sticks[i] == nowlen) return false;
        }
    }

    return false;
}
```

## acwing 168 生日蛋糕

制作一个体积为 $N\pi$ 的 $M$ 层生日蛋糕，每层都是一个圆柱体。设从下往上数第 $i$ 层蛋糕是半径为 $Ri$，高度为 $Hi$ 的圆柱。当 $i<M$ 时，要求 $Ri>Ri+1$ 且 $Hi>Hi+1$。

我们希望蛋糕外表面（最下一层的下底面除外）的面积 $Q$ 最小。令 $Q=S\pi$ ，请编程对给出的 $N$ 和 $M$，找出蛋糕的制作方案（适当的 $Ri$ 和 $Hi$ 的值），使 $S$ 最小。除 $Q$ 外，以上所有数据皆为正整数。

### 思路

[@random_srand](https://www.acwing.com/solution/content/31876/)

记最底层为 $m$，则有表面积和体积公式：

$$
S_{total} = \sum_{i=1}^{m}(2\pi R_i H_i) \\
V_{total} = \sum_{i=1}^{m}(\pi R_i^2 H_i)
$$

优化搜索顺序：层间从下到上；层内先枚举半径再枚举高，从大到小

可行性剪枝：记总体积为 $n$，当前层 $u$，第 $u$ 层的体积为 $V_u$，半径 $R_u$，体积 $V_u$，第 $m$ 层到第 $u$ 层的体积和为 $V$。

1. 半径限制：最小取值应该是当前层号，最大取值取决于下一层半径减一或当前层体积最大值除高度最小值。

$$u\leq R_u\leq min\{R_{u+1}-1,\sqrt{\frac{n-min\sum_{i=1}^{u-1}V_i-V}u}\}$$

2. 高度限制：最小取值应该是当前层号，最大取值取决于下一层高度减一或当前层体积最大值除底面积最小值。



# 广搜

## acwing 174 推箱子

推箱子游戏相信大家都不陌生，在本题中，你将控制一个人把 1 个箱子到目的地。

给定一张 N 行 M 列的地图，用字符 . 表示空地，字符 # 表示墙，字符 S 表示人的起始位置，字符 B 表示箱子的起始位置，字符 T 表示箱子的目标位置。

求一种移动方案，使箱子移动的次数最少，在此基础上再让人移动的总步数最少。

方案中使用大写的 EWSN（东西南北）表示箱子的移动，使用小写的 ewsn（东西南北）表示人的移动。

![acwing 174 pic](https://cdn.acwing.com/media/article/image/2019/01/16/19_8c8e5b0a19-%E6%8E%A8%E7%AE%B1%E5%AD%90.jpg)

### 思路

